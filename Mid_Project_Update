---
title: 'Mid Project Update: Nov 3, 2022'
author: "Emilie Nero, Julia Marques, Sarah Martinez-Fuller, Simon Sevenier"
output:
  html_notebook: default
  pdf_document: default
---

```{r}
library(tidyverse)
```


```{r}
mosquito_data<-read.csv("CDC_host_seeking_mosquitoes_and_MClim_data_NERC.csv")

```

Exploratory Analysis
```{r}
# Removing the columns that we are not looking at (includes male abundances, and maximum and minimum temperature and humidity)
clean_mosquito_data<-subset(mosquito_data, select = -c(Agml,Afml,Acml,Acfem, 
                                  OthAn,MaxTemp,MaxHum,MinTemp,MinHum))

write.csv(clean_mosquito_data, "clean_mosquito_data.csv")
```


```{r}
# Basic descriptions

str(clean_mosquito_data)
head(clean_mosquito_data)
```
```{r}
# Checking the presence of NA

sum(is.na(clean_mosquito_data))
```

```{r}
# Getting the summary of important variables (MeanTemp and MeanHum)
  
summary(clean_mosquito_data$MeanTemp) #in Â°C
summary(clean_mosquito_data$MeanHum)  #in %
```

```{r}
#Histogram of mean temp and mean Hum
par(mfrow=c(1,2))
ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_histogram(aes(x=MeanTemp))+
  labs(title= "distribution of the mean temperature recorded in each sites")

ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_histogram(aes(x=MeanHum))+
  labs(title= "distribution of the mean humidity recorded in each sites")


```

```{r}
# Looking at number of observations in each village
clean_mosquito_data %>% 
  group_by(village) %>% 
  tally()
```

```{r}
# Looking at number of observations in each household
clean_mosquito_data %>% 
  group_by(VillageHH) %>% 
  tally()
```

```{r}
# total number of time 1 or more fed An. gambiae were trapped
clean_mosquito_data %>% 
  filter(!is.na(clean_mosquito_data$Agfed)) %>% 
  count(Agfed>0)
  
# total number of time 1 or more unfed An. gambiae were trapped
clean_mosquito_data %>% 
  filter(!is.na(clean_mosquito_data$Agunf)) %>% 
  count(Agunf>0)

# total number of time 1 or more gravid An. gambiae were trapped
clean_mosquito_data %>% 
  filter(!is.na(clean_mosquito_data$Aggrv)) %>% 
  count(Aggrv>0)
```


```{r}
# Repartition of the number of mosquitoes caught in a trap for fed An. gambiae
# (The histogram looked too bad)

clean_mosquito_data %>% 
  filter(!is.na(clean_mosquito_data$Agfed)) %>% 
  count(Agfed)
```

```{r}
library(gridExtra)

# Investigating Mean Temp on the three states of An. gambiae
ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanTemp, y=Agfed), color='brown')+
  labs(title="Abundance of Agfed depending on the mean temperature", y="abundance")

ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanTemp, y=Agunf), color="orange")+
  labs(title="Abundance of Agunf depending on the mean temperature", y="abundance")

ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanTemp, y=Aggrv), color="purple")+
  labs(title="Abundance of Aggrv depending on the mean temperature", y="abundance")


# Investigating Mean Hum on the three states of An. gambiae
ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanHum, y=Agfed), color='brown')+
  labs(title="Abundance of Agfed depending on the mean temperature", y="abundance")

ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanHum, y=Agunf), color="orange")+
  labs(title="Abundance of Agunf depending on the mean temperature", y="abundance")

ggplot(data=clean_mosquito_data)+theme_classic()+
  geom_point(aes(x=MeanHum, y=Aggrv), color="orange")+
  labs(title="Abundance of Aggrv depending on the mean temperature", y="abundance")

```




Data Collection Methods
The research was conducted and data were collected in the Kilombero Valley, a global malaria hotspot in Tanzania. Since 2007, entomologists from the University of Glasgow have trapped malaria vectors from four households across four villages within the valley (note: vectors were trapped using MET and CDC trap designs). This dataset ranges from June 2016 to September 2017. The individual trapped mosquitoes were sexed, identified as An. gambiae or An. funestus, and classified as fed, unfed and gravid. A number of climatic factors --including maximum, minimum, and mean humidity and temperature-- were tracked daily at each vector trapping site. Standard CDC traps were left overnight inside the households within each village. Each village was visited at least 5 days per month over the project. 
This dataset was collected by the University of Glasgow, in collaboration with the NERC ENvironmental Information Data Centre (a reliable source; it was not open-source community data). As a part of the data manipulation, we removed the columns that we were not investigating. Agml (number of male An. gambiae), Afml (number of male An. funestus) were removed because we are investigating female mosquitoes since they are the only ones who can transmit malaria. We deleted the columns Acml (number of male An.coustani) and Acfem (number of female An.coustani) since there was no data on their fed, unfed or gravid states. OthAn (number of other Anopheles species) was also removed because we are specifically looking at two distinct species. MaxTemp, MaxHum, MinTemp, and MinHum were all removed because we will be using the MeanTemp and MeanHum to investigate our hypotheses.


